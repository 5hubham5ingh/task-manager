"use strict";(self.webpackChunktask_manager=self.webpackChunktask_manager||[]).push([[359],{6184:function(n,e,r){r.d(e,{Z:function(){return c}});var t=r(1582),a=r(890),i=r(4294),s=r(184);function c(n){var e=n.onRetry;return(0,s.jsxs)(t.Z,{direction:"column",alignItems:"center",children:[(0,s.jsx)(a.Z,{variant:"h6",children:"Something went wrong"}),(0,s.jsx)(i.Z,{variant:"contained",size:"small",onClick:e,children:"Retry"})]})}},3414:function(n,e,r){r.d(e,{Z:function(){return i}});var t=r(9434),a=r(3498);function i(n){var e=(0,t.I0)();setTimeout((function(){return n.isPaused?e(a.NV.showSnackbar({message:"Waiting for internet connection",severity:"info",autoHideDuration:null})):e(a.NV.hideSnackbar())}),1e3)}},1257:function(n,e,r){r.d(e,{j:function(){return t}});var t={"&:hover":{backgroundColor:"darkBlue"},backgroundColor:"#3268a8",marginLeft:"auto"}},4202:function(n,e,r){r.d(e,{J:function(){return t}});var t={color:"#3268a8",padding:0,margin:0}},3804:function(n,e,r){r.d(e,{J:function(){return t}});var t={"& .MuiOutlinedInput-root.Mui-focused fieldset":{borderColor:"darkBlue"},"& label.Mui-focused":{color:"darkBlue"}}},5361:function(n,e,r){r.d(e,{Z:function(){return o}});var t=r(4165),a=r(1413),i=r(6459),s=r(5861),c=r(1243).Z.create({baseURL:"http://localhost:5555",withCredentials:!0});function o(n){return u.apply(this,arguments)}function u(){return u=(0,s.Z)((0,t.Z)().mark((function n(e){var r,u,d;return(0,t.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return(r=Object.assign({},((0,i.Z)(e),e))).headers=(0,a.Z)({"Content-Type":"application/json",Accept:"application/json"},r.headers),u=function(n){return n},d=function(){var n=(0,s.Z)((0,t.Z)().mark((function n(e){var a;return(0,t.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(401!==e.response.status||e.response.data.message){n.next=10;break}return(a=localStorage.getItem("refreshToken"))||window.location.replace("/login?session=expired"),r.headers.autherisation=a,n.next=7,o(r);case 7:return n.abrupt("return",n.sent);case 10:401===e.response.status&&window.location.replace("/login?session=expired");case 11:if(!e.response){n.next=13;break}return n.abrupt("return",Promise.reject(e));case 13:return n.abrupt("return",Promise.reject({response:{data:{message:navigator.onLine?"Server is not responding":"System is Offline! Please check your internet connection."}}}));case 14:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),n.next=6,c(r).then(u).catch(d);case 6:return n.abrupt("return",n.sent);case 7:case"end":return n.stop()}}),n)}))),u.apply(this,arguments)}},4359:function(n,e,r){r.r(e),r.d(e,{default:function(){return fn}});var t=r(1413),a=r(9434),i=r(4165),s=r(5861),c=r(4893),o=r(7689),u="/user",d="/user/participants",l=r(5361),p=function(){var n=(0,o.UO)().userId;function e(){return e=(0,s.Z)((0,i.Z)().mark((function n(e){var r,t;return(0,i.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=e.queryKey,t=r[1],n.next=4,(0,l.Z)({url:"".concat(u,"/").concat(t),method:"get"});case 4:return n.abrupt("return",n.sent);case 5:case"end":return n.stop()}}),n)}))),e.apply(this,arguments)}return(0,c.a)({queryKey:["workspaces",n],queryFn:function(n){return e.apply(this,arguments)},refetchOnMount:!0,refetchOnReconnect:!1,refetchOnWindowFocus:!1,refetchOnWindowBlur:!1,enabled:!0,staleTime:6e4,select:function(n){return n.data}})},f=r(3498),h=r(3414),Z=r(6184),x=r(184);function g(n){var e=n.children,r=p(),t=(0,a.I0)();return(0,h.Z)(r),r.isRefetching&&t(f.NV.showSnackbar({severity:"info",message:"Refreshing..."})),r.isError?(0,x.jsx)(Z.Z,{onRetry:r.refetch}):r.isLoading?(0,x.jsx)("div",{children:"Loading..."}):r.isSuccess?e({workspaces:r.data,refetch:r.refetch}):void 0}var v=r(9439),m=r(2791),k=r(1582),w=r(890),b=r(7924),j=r(7621),y=r(9504),C=r(5817),S=r(7247),I=r(3239);function N(n){var e=n.isPending,r=n.deleteWorkspace;return e?(0,x.jsx)(I.Z,{sx:R}):(0,x.jsx)(S.Z,{onClick:r,sx:R})}var R={position:"absolute",right:"5%",bottom:"5%"},P=r(5987),O=r(3713),W=r(8556),L=function(){var n=(0,O.NL)(),e=(0,o.UO)().userId,r=(0,m.useRef)();function a(){return(a=(0,s.Z)((0,i.Z)().mark((function n(t){return(0,i.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r.current=t,n.next=3,(0,l.Z)({url:"".concat("/user","/").concat(e,"/").concat(t),method:"delete"});case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}}),n)})))).apply(this,arguments)}return(0,W.D)({mutationFn:function(n){return a.apply(this,arguments)},onSuccess:function(){n.setQueryData(["workspaces",e],(function(n){return(0,t.Z)((0,t.Z)({},n),{},{data:n.data.filter((function(n){return n._id!==r.current}))})}))}})},F=["children","workspaceId"];function V(n){var e=n.children,r=n.workspaceId,i=(0,P.Z)(n,F),s=L(),c=(0,a.I0)(),o={onSuccess:function(){c(f.NV.showSnackbar({severity:"success",message:"Workspace deleted successfully"}))},onError:function(){c(f.NV.showSnackbar({severity:"error",message:"Error deleting workspace"}))}},u={deleteWorkspace:function(){s.mutate(r,o)},isPending:s.isLoading};return e((0,t.Z)((0,t.Z)({},u),i))}function _(n){return(0,x.jsx)(V,(0,t.Z)((0,t.Z)({},n),{},{children:function(n){return(0,x.jsx)(N,(0,t.Z)({},n))}}))}function E(n){var e=n.workspace,r=(0,C.Fg)().theme,t=(0,o.s0)();return(0,x.jsxs)(j.Z,{sx:{backgroundImage:"linear-gradient(".concat(r,",rgb(140, 140, 243))"),minHeight:"200px",position:"relative"},children:[(0,x.jsxs)(y.Z,{onClick:function(){t("/workspace/".concat(e._id))},children:[(0,x.jsx)(w.Z,{variant:"h4",children:e.name}),(0,x.jsxs)(w.Z,{variant:"subtitle2",children:["Created by: ",e.owner.userName]}),(0,x.jsx)(b.Z,{sx:{borderColor:"black"}}),(0,x.jsx)(w.Z,{variant:"h6",children:"Description: "}),(0,x.jsx)(w.Z,{variant:"subtitle2",paragraph:!0,sx:{width:"100%"},children:e.description}),(0,x.jsx)(w.Z,{variant:"h6",children:"Participants: "}),(0,x.jsx)(w.Z,{variant:"p",paragraph:!0,sx:{width:"100%"},children:e.participants.map((function(n,e,r){return"".concat(n.userName).concat(e===r.length-1?"":","," ")}))})]}),(0,x.jsx)(_,{workspaceId:e._id})]})}var M=r(6002),A=r(5926),D=r(3433),J=function(n){var e=(0,o.UO)().userId,r=(0,O.NL)(),a=(0,m.useRef)();function c(){return(c=(0,s.Z)((0,i.Z)().mark((function n(r){return(0,i.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a.current=r,n.next=3,(0,l.Z)({url:"".concat(u,"/").concat(e),method:"post",data:r});case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}}),n)})))).apply(this,arguments)}return(0,W.D)({mutationFn:function(n){return c.apply(this,arguments)},onSuccess:function(i){var s=(0,t.Z)({_id:i.data._id},a.current);r.setQueryData(["workspaces",e],(function(e){return n&&n(),(0,t.Z)((0,t.Z)({},e),{},{data:[].concat((0,D.Z)(e.data),[s])})}))}})},T=["children","closeModal"];function U(n){var e=n.children,r=n.closeModal,i=(0,P.Z)(n,T),s=J(r),c=(0,a.I0)();(0,h.Z)(s);var o={onSuccess:function(){c(f.NV.showSnackbar({message:"Workspace added successfully",severity:"success"}))},onError:function(){c(f.NV.showSnackbar({message:"Error adding workspace",severity:"error"}))}},u=(0,t.Z)({handleSubmit:function(n){return s.mutate(n,o)},isAddingNewWorkspace:s.isPending,closeModal:r},i);return e((0,t.Z)({},u))}var q=r(1621),B=["children","handleSubmit"];function z(n){var e=n.children,r=n.handleSubmit,a=(0,P.Z)(n,B),c=(0,m.useState)(""),o=(0,v.Z)(c,2),u=o[0],d=o[1],l=(0,q.a)(),p=l._id,f=l.userName,h=function(){var n=(0,s.Z)((0,i.Z)().mark((function n(e){var a;return(0,i.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(""!==e.name){n.next=3;break}return d("Name is required!"),n.abrupt("return");case 3:a=(0,t.Z)((0,t.Z)({},e),{},{owner:{_id:p,userName:f}}),r(a);case 5:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();return e((0,t.Z)({handleValidation:h,validationError:u},a))}var H=r(4554),K=r(4391),Q=r(4294),G=r(1257),X=r(4202),Y={height:"100vh",width:"100vw",position:"fixed",display:"flex",alignItems:"center",justifyContent:"center"},$=r(3804),nn=function(n){var e=n.onClick;return(0,x.jsx)("div",{style:{position:"fixed",backgroundColor:"rgba(0, 0, 0, 0.5)",width:"100vw",height:"100vh",backdropFilter:"blur(5px)",zIndex:-999},onClick:e})},en=r(4215),rn=r(5527);function tn(n){var e=n.handleChange,r=n.isSearching,a=n.searchUser,i=n.stopSearch,s=n.options,c=n.isLoading;return(0,x.jsx)(en.Z,{onChange:e,fullwidth:!0,PaperComponent:function(n){var e=n.children;return(0,x.jsx)(rn.Z,{style:{background:"#abdaed"},children:e})},sx:{background:"transparent",borderRadius:"20px"},open:r,multiple:!0,onClose:function(){i(!1)},isOptionEqualToValue:function(n,e){return n.userName===e.userName},getOptionLabel:function(n){return n.userName},options:s,loading:c,renderInput:function(n){return(0,x.jsx)(K.Z,(0,t.Z)((0,t.Z)({sx:$.J},n),{},{label:"Participants",onChange:function(n){console.log("change"),a(n.target.value)},InputProps:(0,t.Z)((0,t.Z)({},n.InputProps),{},{endAdornment:(0,x.jsxs)(m.Fragment,{children:[c?(0,x.jsx)(I.Z,{color:"inherit",size:20}):null,n.InputProps.endAdornment]})})}))}})}function an(n){var e=n.children,r=n.participants,t=(0,m.useState)(!1),a=(0,v.Z)(t,2),c=a[0],o=a[1],u=(0,m.useState)([]),p=(0,v.Z)(u,2),f=p[0],h=p[1],Z=c&&0===f.length;(0,m.useEffect)((function(){c||h([])}),[c]);return e({isSearching:c,searchUser:function(n){n.length%3===0&&0!==n.length&&(o(!0),(0,s.Z)((0,i.Z)().mark((function e(){var r;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,l.Z)({url:"".concat(d,"?userName=").concat(n),method:"get"});case 3:r=e.sent,h(r.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log("error while fetching participants list",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))())},stopSearch:function(){o(!1)},options:f,isLoading:Z,handleChange:function(n,e){r.current=e}})}function sn(n){return(0,x.jsx)(an,(0,t.Z)((0,t.Z)({},n),{},{children:function(n){return(0,x.jsx)(tn,(0,t.Z)({},n))}}))}function cn(n){var e=n.closeModal,r=n.isAddingNewWorkspace,t=n.handleValidation,a=n.validationError,c=(0,C.Fg)().theme,o=(0,m.useRef)(""),u=(0,m.useRef)(""),d=(0,m.useRef)(""),l=function(){var n=(0,s.Z)((0,i.Z)().mark((function n(){var e;return(0,i.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e={name:o.current.value||"",description:u.current.value||"",participants:d.current||[]},t(e);case 2:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();return(0,x.jsxs)(H.Z,{direction:"column",sx:Y,children:[(0,x.jsx)(nn,{onClick:e}),(0,x.jsxs)(k.Z,{sx:{backgroundImage:"linear-gradient(".concat(c,",rgb(140, 140, 243))"),borderRadius:"20px"},component:"form",className:"form",p:"2vw",spacing:"2vw",children:[(0,x.jsx)(w.Z,{sx:X.J,variant:"h6",children:"Add new Workplace"}),(0,x.jsx)(K.Z,{label:"Name",inputRef:o,error:Boolean(a),helperText:a,sx:$.J}),(0,x.jsx)(K.Z,{label:"Description",inputRef:u,sx:$.J}),(0,x.jsx)(sn,{participants:d}),(0,x.jsx)(Q.Z,{variant:"contained",sx:G.j,size:"large",onClick:l,children:r?"adding...":"Add"})]})]})}function on(n){return(0,x.jsx)(U,(0,t.Z)((0,t.Z)({},n),{},{children:function(n){return(0,x.jsx)(z,(0,t.Z)((0,t.Z)({},n),{},{children:function(n){return(0,x.jsx)(cn,(0,t.Z)({},n))}}))}}))}var un=r(3950);function dn(n){var e=n.workspaces,r=n.refetch,t=(0,m.useState)(!1),a=(0,v.Z)(t,2),i=a[0],s=a[1],c=(0,C.Fg)().theme;return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)(A.g,{children:[(0,x.jsxs)(M.ZP,{columns:{xs:1,sm:2,md:4},spacing:4,sx:{margin:5},children:[(0,x.jsxs)(k.Z,{direction:"column",justifyContent:"center",alignItems:"center",spacing:2,md:3,sx:{backgroundImage:"linear-gradient(".concat(c,",rgb(140, 140, 243))"),p:"40px"},onClick:function(){return s(!0)},children:[(0,x.jsx)(w.Z,{variant:"h7",children:"Add new Work space."}),(0,x.jsx)("span",{children:"\u2795"})]},100),e.length?e.map((function(n){return(0,x.jsx)(E,{workspace:n},n._id)})):(0,x.jsx)("div",{style:pn,children:"No Workspace found."})]}),(0,x.jsx)(un.Z,{color:"blue",sx:ln,onClick:function(){return r()}})]}),i&&(0,x.jsx)(on,{closeModal:function(){return s(!1)}})]})}var ln={position:"absolute",right:"1%",bottom:"1%"},pn={position:"fixed",top:"50%",left:"45%"};function fn(){return(0,x.jsx)(g,{children:function(n){return(0,x.jsx)(dn,(0,t.Z)({},n))}})}}}]);
//# sourceMappingURL=359.a0b5935b.chunk.js.map